<!doctype html>
<html lang="en" prefix="og: http://ogp.me/ns#">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- SEO -->
        <title>CI/CD Basics</title>
        <meta name="description" content="The basics of CI/CD pipelines, github actions and github pages">

        <!-- URL CANONICAL -->
        <link rel="canonical" href="https://kieranwood.ca/ci-cd-basics/">

        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,700,700i%7CMaitree:200,300,400,600,700&amp;subset=latin-ext" rel="stylesheet">

        <!-- CSS WebSlides -->
        <link rel="stylesheet" type='text/css' media='all' href="static/css/webslides.css">

        <!-- Optional - CSS SVG Icons (Font Awesome) -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin="anonymous" />

        <!-- SOCIAL CARDS (ADD YOUR INFO) -->

        <!-- FACEBOOK -->
        <meta property="og:url" content="https://kieranwood.ca/ci-cd-basics/">
        <meta property="og:type" content="article">
        <meta property="og:title" content="CI/CD Basics"> 
        <meta property="og:description" content="The basics of CI/CD pipelines, github actions and github pages">
        <meta property="og:updated_time" content="2022-06-29 05:55:24.053895">
        <meta property="og:image" content="static/images/share-webslides.jpg">

        <!-- TWITTER -->
        <meta name="twitter:card" content="summary_large_image">
        <meta name="twitter:title" content="CI/CD Basics"> 
        <meta name="twitter:description" content="The basics of CI/CD pipelines, github actions and github pages"> 
        <meta name="twitter:image" content="static/images/share-webslides.jpg">

        <!-- FAVICONS -->
            <link rel="apple-touch-icon icon" sizes="76x76" href="static/images/favicons/favicon-152.png">

        <!-- Android -->
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="theme-color" content="#f0f0f0">

        <!-- Code highlighting -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.4.0/styles/default.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.4.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>

    </head>
    
    <body>

    <main role='main'>
        <article id='webslides' >
			<section class='bg-gray'>
                    <div class='wrap aligncenter'>
                        <h1><strong>CI/CD Basics</strong></h1>
                        <p class='text-intro'>The basics of CI/CD pipelines, github actions and github pages</p>
                    </div>
            </section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>What is Continuous Integration/Continuous Deployment?</h2>
					<p>Essentially it is a method for defining automated virtual computing processes. In laymens terms it typically means writing a configuration file or script that will spin up a 'virtual computer' (though sometimes it will run on the host computer) and run through a series of defined tasks.</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>What is CI/CD Used for?</h2>
					<p>Any task that you might want a 'virtual computer' to run it on for example</p>
					<div class='grid content-center'>
							<ul style='text-align:justify;'>
								<li>Testing</li>
								<li>Building a distribution</li>
								<li>Automated updating</li>
								<li>etc.</li>
					</div>
							</ul>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Pipeline/Workflow vs jobs/steps</h2>
					<p> A pipeline/workflow is the full definition of the task (can mean the file or the actions). Jobs/steps are the individual actions or group of actions that make up a pipeline/workflow</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Environment</h2>
					<p>The environment the pipeline/workflow runs in including the operating system, any configuration variables, and any included binaries/languages</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Strategy for making a pipeline</h2>
					<p>Imagine you have someone you are training to do the task. They have a brand new laptop and you need to help them get setup and do the task</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>An example</h2>
					<p>Last week we looked at using hugo with the ignite site, what are the steps needed to build the ignite site if you were given a brand new laptop?</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Overview of steps for the example</h2>
					<p>First we need to clone the site so we have the files, next we need to install hugo, then we need to build them (hugo -d), and finally we need to take the files and put them somewhere other people can access them</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Step 1: Clone the site so we have the files</h2>
					<p>First we need to clone the site down, this means we will need some sort of OS and git along with a URL to clone the files down. So once we have an os we need to run:</p>
					<pre><code class='language-bash'>git clone https://github.com/Schulich-Ignite/website</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Step 2: We need to install hugo</h2>
					<p>This means either installing go and installing hugo that way, or downloading a binary</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Step 3: Build the files</h2>
					<p>Need to run the hugo command over the files we downloaded</p>
					<pre><code class='language-bash'>hugo -d</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Step 4: Deploy the files</h2>
					<p>Find a way to deploy those files so other people can access them (will cover this in detail tomorrow)</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Some example systems</h2>
					<p>Every system is a little different. Don't worry about understanding these fully, we will cover one system in depth later these are just here to show other approaches</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Jenkins</h2>
					<p>Example jenkinsfile (printing Hello world! at cli)</p>
					<pre><code class='language-jenkins'>pipeline {
    agent any 
    stages {
        stage('Stage 1') {
            steps {
                echo 'Hello world!' 
            }
        }
    }
}</code></pre>

					<a href=https://www.jenkins.io/ target='_blank' rel='external' style='color:#ff0000;'>Site</a>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Ansible</h2>
					<pre><code class='language-ansible'>---
- name: This is a hello-world example
  hosts: ansibleclient01.local
  tasks:
    - name: Create a file called '/tmp/testfile.txt' with the content 'hello world'.
      copy:
        content: hello worldn
        dest: /tmp/testfile.txt</code></pre>

					<a href=https://www.ansible.com/ target='_blank' rel='external' style='color:#ff0000;'>Site</a>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Gitlab CI/CD</h2>
					<pre><code class='language-gitlab'>build-job:
  stage: build
  script:
    - echo "Hello World!"
</code></pre>

					<a href=https://docs.gitlab.com/ee/ci/ target='_blank' rel='external' style='color:#ffff00;'>Site</a>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Travis CI</h2>

					<a href=https://www.travis-ci.com/ target='_blank' rel='external' style='color:#0000ff;'>Site</a>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Azure</h2>

					<a href=https://azure.microsoft.com/en-us/services/devops/pipelines/ target='_blank' rel='external' style='color:#0000ff;'>Site</a>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>CI/CD is not always remote</h2>
					<p>Some CI/CD processes are run locally on people's devices like local testing pipelines (some people say this isn't ci/cd some say it is)</p>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>CI/CD vs PaaS (platforms as a service)</h2>
					<p>PaaS services like heroku are designed to be a one-stop shop for setting up a project, they tend to be more efficient but they are by design less flexible than standard CI/CD systems</p>

					<a href=https://www.heroku.com/ target='_blank' rel='external' style='color:#79589F;'>Heroku</a>

					</div>
				</div>
			</section>

			<section class='bg-gray slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>CI/CD vs containers</h2>
					<p>Containers are essentially a way to run code inside a 'mini computer' inside a computer. Some CI/CD systems use containers, but containers are not themselves CI/CD systems necessarily</p>

					<a href=https://www.docker.com/ target='_blank' rel='external' style='color:#2496ed;'>Docker</a>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Github Actions</h2>
					<p>Github actions is a remote CI/CD system that is integrated with github directly</p>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Github Actions Files are YML/YAML</h2>
					<p>Github actions files are written in YAML/YML</p>

					<a href=https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html#yaml-basics target='_blank' rel='external' style='color:#4dd;'>YAML Syntax</a>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>For example this presentation has a pipeline</h2>
					<pre><code class='language-yaml'>name: GH build for ezprez

on:
  push:
    branches:
      - master
      - main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repo
      uses: actions/checkout@v2
    - name: Setup Python
      uses: actions/setup-python@v2
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        python -m pip install --upgrade setuptools wheel
        python -m pip install ezprez
    - name: build html files
      run: |
        mkdir ~/Downloads
        python example.py
        mv Presentation/* .
        rm -rf Presentation
    - name: Deploy Docs
      uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: .
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Github Actions File structure</h2>
					<p>They go in a folder in your repository called /.github/workflows (you can have multiple pipelines)</p>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Triggers</h2>
					<p>This configuration determines when an action pipeline runs. Note that multiple pipelines can be run off a single trigger, and pipelines finishing can trigger other pipelines to start. After a name parameter you need to add an 'on'</p>
					<pre><code class='language-yaml'>name: GH build for ezprez

on:
  ... # This is where you add your trigger
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>On push (all branches)</h2>
					<pre><code class='language-yaml'>name: GH build for ezprez

on:
  [push] # all branches

</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>On push (specific branches)</h2>
					<pre><code class='language-yaml'>name: GH build for ezprez

on:
  push:
    branches: # Only rub on a push to master or main
      - master
      - main

</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>On Workflow dispatch (No Inputs)</h2>
					<pre><code class='language-yaml'>name: GH build for ezprez

on:
  workflow_dispatch # Manually start the pipeline
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>On Workflow dispatch (Inputs)</h2>
					<pre><code class='language-yaml'>name: GH build for ezprez

on:
  workflow_dispatch: # Manually start the pipeline
    inputs:
        doc_system: # Can access value ${{ github.event.inputs.doc_system }}
          description: Either pdoc, or mkdocs # Description shows under field
          default: pdoc # Provide a default
          required: true # Make field required or not
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>On Workflow dispatch (Inputs)</h2>
<img src='./static/images/workflow-dispatch.png' alt='workflow-dispatch' >
					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>On Schedule/Cron</h2>

					<a href=https://crontab.cronhub.io target='_blank' rel='external' style='color:#4dd;'>Online editor for crontab format</a>
					<pre><code class='language-yaml'>name: GH build for ezprez

on:
  schedule:
    # Run at 5:05 pm on mondays and wednesdays
    - cron: '5 17 * * 1,3'
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Jobs</h2>
					<p>Each job is essentially a set of steps with some associated state. Each job runs in it's own 'runner' with it's own 'virtual environment'(container)</p>
					<pre><code class='language-yaml'>name: name of workflow

on:
  ... # This is where you add your trigger

jobs:
  job_name:
    name: You can also specify a name here
    ... # environment definition
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Environment definitions</h2>
					<p>The information used to configure all steps in a job</p>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>runs-on</h2>
					<p>This defines what OS the workflow runs on</p>
					<pre><code class='language-yaml'>name: name of workflow

on:
  ... # This is where you add your trigger

jobs:
  job_name:
    name: You can also specify a name here
    runs-on: ubuntu-latest # can also be a matrix you iterate over
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Strategy</h2>
					<p>Used to create arrays that are itterated over to run a job multiple times</p>
					<pre><code class='language-yaml'>name: name of workflow

on:
  ... # This is where you add your trigger

jobs:
  job_name:
    name: You can also specify a name here
    runs-on: ${{ matrix.os }} # Would run this with ubuntu-latest first, then windows-latest, then macos-latest
    strategy:
      matrix:
        python_version: ['3.7', '3.8', '3.9', '3.10'] # Can use this later on
        os: [ubuntu-latest, windows-latest, macOS-latest]
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Steps</h2>
					<p>This is where actual commands are run. Note that state is typically persistant across steps in the same job. Note you can use other people's actions by passing the repo name</p>
					<pre><code class='language-yaml'>name: name of workflow

on:
  ... # This is where you add your trigger

jobs:
  job_name:
    ... # your job config

    steps:
    - uses: actions/checkout@v2 # minimal example
    - name: Set up Python ${{ matrix.python_version }} # Using a more complex pre-built example
      uses: actions/setup-python@v1 # https://github.com/actions/setup-python
      with:
        python-version: ${{ matrix.python_version }}
    - name: Install dependencies # Example of running raw bash commands
      run: |
        pip install .
        pip install pytest
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Using with</h2>
					<p>With can be used to define settings for each step in a job. There are some standard one's we will cover but keep in mind custom actions often have custom settings you can use alongside the with section. It is essentially where you can stick any configuration for a step you need</p>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Secrets</h2>
					<p>In github you can set a secret, which is a key-value pair that is kept completely secret (like a password). Be aware once set you can only modify or delete, you cannot read the value again</p>
<img src='./static/images/secrets.png' alt='secrets' >
					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>With options: token</h2>
					<p>Tokens are used to authenticate an action and are what allows the action access to make changes or even just access content that is locked behind a password/github account. They use different formats, but here is an example</p>
					<pre><code class='language-yaml'>name: Publish Site
on:
  ...
jobs:
  build-deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Publish Site
        uses: chabad360/hugo-gh-pages@master
        with:
          githubToken: ${{ secrets.PERSONAL_TOKEN }} # In this case this is where you set a personal access token to your account
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>With options: artifacts</h2>
					<pre><code class='language-yaml'>name: Create theme release # Taken from https://github.com/QU-UP/ezcv-themes/blob/main/.github/workflows/release.yml
on:
  workflow_dispatch:
    inputs:
      version_number:
        description: The version number to release
        default: "0.1.0"
        required: true
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout repo
      uses: actions/checkout@v2

    - name: Create zip files
      ... # creates a bunch of zip files
    - name: Create release draft
      uses: ncipollo/release-action@v1
      with:
        artifacts: "*.zip" # Include zip files in releases draft
        tag: ${{ github.event.inputs.version_number }}
        draft: true
        token: ${{ secrets.GITHUB_TOKEN }}
</code></pre>

					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>What does this look like?</h2>
<img src='./static/images/actions-status.png' alt='actions-status' >
					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>What does this look like?</h2>
<img src='./static/images/actions-overview.png' alt='actions-overview' >
					</div>
				</div>
			</section>

			<section class='bg-black slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>What does this look like?</h2>
<img src='./static/images/workflow-run-summary.png' alt='workflow-run-summary' >
					</div>
				</div>
			</section>

			<section class='bg-black-blue slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Github Pages</h2>
					<p>Github pages is a host for static site files. Imagine a google drive/dropbox/onedrive but for html files so that people can access the files on the web. It also provides a full http server as well</p>

					</div>
				</div>
			</section>

			<section class='bg-black-blue slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Github Pages setup</h2>
					<p>You can either have your html files in your regular source or on a gh-pages branch. You need an index.html file for either</p>

					</div>
				</div>
			</section>

			<section class='bg-black-blue slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Github Pages setup</h2>
					<p>Once you have the content where you want it, you can configure the settings for github pages from the repository (by default <username>.github.io is the domain used, and should be the repository name)</p>
<img src='./static/images/pages-setup.png' alt='pages-setup' >
					</div>
				</div>
			</section>

			<section class='bg-black-blue slide-center'>
				<div class='wrap fadeIn'>
					<div class='content-center'>
					<h2>Github Pages deployment</h2>
					<p>Once you have finished the configuration a github action will run to actually deploy the files to github's servers</p>
<img src='./static/images/gh-pages-deploy.png' alt='gh-pages-deploy' >
					</div>
				</div>
			</section>

			<section class='bg-gray'>
                    <div class='wrap aligncenter'>
                        <h2><strong>Thank you</strong></h2>
                        <h4 class='text-intro'>This presentation was made with the help of</h4>
                        <h4>
                            <strong><em><a href='https://webslides.tv' target='_blank'>WebSlides</a></em></strong> 
                        </h4>
                        <h4>
                            <strong><em><a href='https://github.com/Descent098/ezprez' target='_blank'>ezprez</a></em></strong>
                        </h4>
                    </div>
            </section>

        </article>
        <!-- end article -->
    </main>
    <!-- end main -->

    <!-- Required -->
    <script src='static/js/webslides.js'></script>
    <script>
        window.ws = new WebSlides();
    </script>

    <!-- OPTIONAL - svg-icons.js (fontastic.me - Font Awesome as svg icons) -->
    <script defer src='static/js/svg-icons.js'></script>

    </body>
    
</html>
        